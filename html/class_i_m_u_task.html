<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sport Trackr Design Review: IMUTask Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Sport Trackr Design Review<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">A sophisticated dual-axis motor control system that automatically tracks LED targets using computer vision feedback. The system combines real-time image processing, inertial measurement, and PID control to enable autonomous tracking or manual teleoperation via a web interface.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('class_i_m_u_task.html','','class_i_m_u_task-members'); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">IMUTask Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Continuous IMU sensor data acquisition task with <a class="el" href="class_f_s_m.html">FSM</a> control.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_i_m_u___t_a_s_k_8h_source.html">IMU_TASK.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-types" class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ab753136579c24435a9358626f45da9ca" id="r_ab753136579c24435a9358626f45da9ca"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab753136579c24435a9358626f45da9ca">StateId</a> : uint8_t { <a class="el" href="#ab753136579c24435a9358626f45da9caa1e449c519d4e3dcfef62a1346e5d6495">WAIT</a> = 0
, <a class="el" href="#ab753136579c24435a9358626f45da9caadf0b6100763d821f728de9a5a611099d">SEND_DATA</a> = 1
 }</td></tr>
<tr class="memdesc:ab753136579c24435a9358626f45da9ca"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_f_s_m.html">FSM</a> state identifiers for IMU task operation.  <a href="#ab753136579c24435a9358626f45da9ca">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-methods" class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad1c54b7c4deead447dd97d3b26eb135c" id="r_ad1c54b7c4deead447dd97d3b26eb135c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad1c54b7c4deead447dd97d3b26eb135c">IMUTask</a> (<a class="el" href="class_adafruit___b_n_o055.html">Adafruit_BNO055</a> *imu, Share&lt; <a class="el" href="struct_euler_angles.html">EulerAngles</a> &gt; *<a class="el" href="struct_euler_angles.html">EulerAngles</a>, Share&lt; <a class="el" href="struct_gyro_data.html">GyroData</a> &gt; *<a class="el" href="struct_gyro_data.html">GyroData</a>, Share&lt; <a class="el" href="struct_accel_data.html">AccelData</a> &gt; *<a class="el" href="struct_accel_data.html">AccelData</a>, uint32_t updateMs=500) noexcept</td></tr>
<tr class="memdesc:ad1c54b7c4deead447dd97d3b26eb135c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new IMU Task object.  <br /></td></tr>
<tr class="memitem:a81db980a2c8f7be5174ccd20d39dd751" id="r_a81db980a2c8f7be5174ccd20d39dd751"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a81db980a2c8f7be5174ccd20d39dd751">initIMU</a> ()</td></tr>
<tr class="memdesc:a81db980a2c8f7be5174ccd20d39dd751"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the BNO055 sensor hardware.  <br /></td></tr>
<tr class="memitem:abfa7658c2d1e6eda10bc332a48667e30" id="r_abfa7658c2d1e6eda10bc332a48667e30"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abfa7658c2d1e6eda10bc332a48667e30">start</a> (uint8_t priority=1, int8_t core=-1)</td></tr>
<tr class="memdesc:abfa7658c2d1e6eda10bc332a48667e30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the IMU FreeRTOS task.  <br /></td></tr>
<tr class="memitem:a6dd4ce19e4790858f3a9e6a6f349d2ee" id="r_a6dd4ce19e4790858f3a9e6a6f349d2ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6dd4ce19e4790858f3a9e6a6f349d2ee">update</a> () noexcept</td></tr>
<tr class="memdesc:a6dd4ce19e4790858f3a9e6a6f349d2ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute one <a class="el" href="class_f_s_m.html">FSM</a> cycle - read sensor and update shares.  <br /></td></tr>
<tr class="memitem:a2445ab1fcc5f513a3b5acfb8a8968888" id="r_a2445ab1fcc5f513a3b5acfb8a8968888"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2445ab1fcc5f513a3b5acfb8a8968888">printCalibrationStatus</a> ()</td></tr>
<tr class="memdesc:a2445ab1fcc5f513a3b5acfb8a8968888"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print current calibration status to Serial Displays system, gyro, accel, and mag calibration levels (0-3)  <br /></td></tr>
<tr class="memitem:adef8c108195c7960ee1b1e6bac093401" id="r_adef8c108195c7960ee1b1e6bac093401"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adef8c108195c7960ee1b1e6bac093401">isFullyCalibrated</a> ()</td></tr>
<tr class="memdesc:adef8c108195c7960ee1b1e6bac093401"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if sensor is fully calibrated (all subsystems at level 3)  <br /></td></tr>
<tr class="memitem:a585d4d1660cb0384d7eda70a58832f1f" id="r_a585d4d1660cb0384d7eda70a58832f1f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a585d4d1660cb0384d7eda70a58832f1f">isDataReliable</a> ()</td></tr>
<tr class="memdesc:a585d4d1660cb0384d7eda70a58832f1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if sensor data is reliable (system calibration &gt;= 1)  <br /></td></tr>
<tr class="memitem:ad28cac79ccdfabaf0a303256d5538359" id="r_ad28cac79ccdfabaf0a303256d5538359"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad28cac79ccdfabaf0a303256d5538359">getCalibrationOffsets</a> (<a class="el" href="structadafruit__bno055__offsets__t.html">adafruit_bno055_offsets_t</a> *offsets)</td></tr>
<tr class="memdesc:ad28cac79ccdfabaf0a303256d5538359"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read current calibration offsets from sensor.  <br /></td></tr>
<tr class="memitem:a55ce116a01e25836c9f0094e788bd15c" id="r_a55ce116a01e25836c9f0094e788bd15c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a55ce116a01e25836c9f0094e788bd15c">setCalibrationOffsets</a> (const <a class="el" href="structadafruit__bno055__offsets__t.html">adafruit_bno055_offsets_t</a> *offsets)</td></tr>
<tr class="memdesc:a55ce116a01e25836c9f0094e788bd15c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write calibration offsets to sensor.  <br /></td></tr>
<tr class="memitem:a8f4d046a615f404983eb9f055771b11d" id="r_a8f4d046a615f404983eb9f055771b11d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8f4d046a615f404983eb9f055771b11d">printCalibrationOffsets</a> ()</td></tr>
<tr class="memdesc:a8f4d046a615f404983eb9f055771b11d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print current calibration offsets to Serial Useful for recording offsets to hardcode in firmware.  <br /></td></tr>
<tr class="memitem:ace03e3c1d0c608ead75e259f9d334d6c" id="r_ace03e3c1d0c608ead75e259f9d334d6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ace03e3c1d0c608ead75e259f9d334d6c">performCalibration</a> (uint32_t timeoutMs=60000)</td></tr>
<tr class="memdesc:ace03e3c1d0c608ead75e259f9d334d6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform interactive calibration procedure.  <br /></td></tr>
<tr class="memitem:a2c28e6a4d383a13bdda9e748de181530" id="r_a2c28e6a4d383a13bdda9e748de181530"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2c28e6a4d383a13bdda9e748de181530">loadSavedCalibration</a> ()</td></tr>
<tr class="memdesc:a2c28e6a4d383a13bdda9e748de181530"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load hardcoded calibration offsets Apply pre-saved calibration data from savedCalibrationData_ array.  <br /></td></tr>
<tr class="memitem:a5f17e194f522641a58a0ff54ce4a65c6" id="r_a5f17e194f522641a58a0ff54ce4a65c6"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a5f17e194f522641a58a0ff54ce4a65c6">get_updateMs</a> () const noexcept</td></tr>
<tr class="memdesc:a5f17e194f522641a58a0ff54ce4a65c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get current sample interval.  <br /></td></tr>
<tr class="memitem:a09aee3391a75fa643391764a7a7c90b1" id="r_a09aee3391a75fa643391764a7a7c90b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a09aee3391a75fa643391764a7a7c90b1">setSampleInterval</a> (uint32_t intervalMs)</td></tr>
<tr class="memdesc:a09aee3391a75fa643391764a7a7c90b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Change sample interval at runtime.  <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-pub-static-methods" class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:adfb9db9321d1d5e15f060e7da3e41a84" id="r_adfb9db9321d1d5e15f060e7da3e41a84"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adfb9db9321d1d5e15f060e7da3e41a84">set_instance</a> (<a class="el" href="class_i_m_u_task.html">IMUTask</a> *inst)</td></tr>
<tr class="memdesc:adfb9db9321d1d5e15f060e7da3e41a84"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set static instance pointer for <a class="el" href="class_f_s_m.html">FSM</a> callbacks.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Continuous IMU sensor data acquisition task with <a class="el" href="class_f_s_m.html">FSM</a> control. </p>
<p>Manages the BNO055 IMU sensor in a dedicated FreeRTOS task, providing continuous streaming of orientation, angular velocity, and acceleration data. The task operates in SEND_DATA state continuously for real-time telemetry updates.</p>
<p><a class="el" href="class_f_s_m.html">FSM</a> States:</p><ul>
<li><b>WAIT</b>: Initial state, transitions immediately to SEND_DATA after first sample</li>
<li><b>SEND_DATA</b>: Continuous data acquisition and publication (does not return to WAIT)</li>
</ul>
<p>Thread Safety:</p><ul>
<li>All data outputs use Share&lt;T&gt; for atomic read/write operations</li>
<li>Safe to access from multiple consumer tasks</li>
<li>No mutex required for reading published data</li>
</ul>
<p>Calibration:</p><ul>
<li>Supports runtime calibration status monitoring</li>
<li>Can save/restore calibration offsets for faster startup</li>
<li>Checks for minimum magnetic calibration before trusting data</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Uses static instance pattern for <a class="el" href="class_f_s_m.html">FSM</a> callback integration </dd>
<dd>
Sample rate configurable but limited by I2C bus speed (~100Hz max practical) </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#ace03e3c1d0c608ead75e259f9d334d6c" title="Perform interactive calibration procedure.">performCalibration()</a> for calibration procedure </dd></dl>
</div><a name="doc-enum-members" id="doc-enum-members"></a><h2 id="header-doc-enum-members" class="groupheader">Member Enumeration Documentation</h2>
<a id="ab753136579c24435a9358626f45da9ca" name="ab753136579c24435a9358626f45da9ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab753136579c24435a9358626f45da9ca">&#9670;&#160;</a></span>StateId</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#ab753136579c24435a9358626f45da9ca">IMUTask::StateId</a> : uint8_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="class_f_s_m.html">FSM</a> state identifiers for IMU task operation. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ab753136579c24435a9358626f45da9caa1e449c519d4e3dcfef62a1346e5d6495" name="ab753136579c24435a9358626f45da9caa1e449c519d4e3dcfef62a1346e5d6495"></a>WAIT&#160;</td><td class="fielddoc"><p>Initial state, waits for first sample interval. </p>
</td></tr>
<tr><td class="fieldname"><a id="ab753136579c24435a9358626f45da9caadf0b6100763d821f728de9a5a611099d" name="ab753136579c24435a9358626f45da9caadf0b6100763d821f728de9a5a611099d"></a>SEND_DATA&#160;</td><td class="fielddoc"><p>Continuous data acquisition and publishing. </p>
</td></tr>
</table>

</div>
</div>
<a name="doc-constructors" id="doc-constructors"></a><h2 id="header-doc-constructors" class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad1c54b7c4deead447dd97d3b26eb135c" name="ad1c54b7c4deead447dd97d3b26eb135c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1c54b7c4deead447dd97d3b26eb135c">&#9670;&#160;</a></span>IMUTask()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IMUTask::IMUTask </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_adafruit___b_n_o055.html">Adafruit_BNO055</a> *</td>          <td class="paramname"><span class="paramname"><em>imu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Share&lt; <a class="el" href="struct_euler_angles.html">EulerAngles</a> &gt; *</td>          <td class="paramname"><span class="paramname"><em>EulerAngles</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Share&lt; <a class="el" href="struct_gyro_data.html">GyroData</a> &gt; *</td>          <td class="paramname"><span class="paramname"><em>GyroData</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Share&lt; <a class="el" href="struct_accel_data.html">AccelData</a> &gt; *</td>          <td class="paramname"><span class="paramname"><em>AccelData</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>updateMs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">500</span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel noexcept">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct a new IMU Task object. </p>
<p>Construct IMU task with sensor configuration and data shares.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">imu</td><td>Pointer to initialized <a class="el" href="class_adafruit___b_n_o055.html" title="Class that stores state and functions for interacting with BNO055 Sensor.">Adafruit_BNO055</a> sensor object </td></tr>
    <tr><td class="paramname"><a class="el" href="struct_euler_angles.html" title="Container for absolute orientation in 3D space.">EulerAngles</a></td><td>Pointer to shared euler angle data container </td></tr>
    <tr><td class="paramname"><a class="el" href="struct_gyro_data.html" title="Container for angular velocity measurements.">GyroData</a></td><td>Pointer to shared gyroscope data container </td></tr>
    <tr><td class="paramname"><a class="el" href="struct_accel_data.html" title="Container for linear acceleration measurements.">AccelData</a></td><td>Pointer to shared accelerometer data container </td></tr>
    <tr><td class="paramname">updateMs</td><td>Sample interval in milliseconds (default 500ms = 2Hz)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>updateMs determines telemetry rate; lower values increase CPU load </dd>
<dd>
Recommended range: 100ms (10Hz) to 1000ms (1Hz)</dd></dl>
<p>Initializes the IMU task with pointers to the BNO055 sensor and shared data containers. Also loads hardcoded calibration offsets for faster startup.</p>
<p>Calibration offsets are specific to the physical sensor and mounting orientation:</p><ul>
<li>Accel: (-44, 0, -46)</li>
<li>Gyro: (-1, 0, 1) <br  />
</li>
<li>Mag: (-9, -277, -288)</li>
<li>Accel Radius: 1000, Mag Radius: 645</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">imu</td><td>Pointer to initialized <a class="el" href="class_adafruit___b_n_o055.html" title="Class that stores state and functions for interacting with BNO055 Sensor.">Adafruit_BNO055</a> sensor object </td></tr>
    <tr><td class="paramname"><a class="el" href="struct_euler_angles.html" title="Container for absolute orientation in 3D space.">EulerAngles</a></td><td>Shared container for euler angles (roll, pitch, yaw) </td></tr>
    <tr><td class="paramname"><a class="el" href="struct_gyro_data.html" title="Container for angular velocity measurements.">GyroData</a></td><td>Shared container for angular velocities </td></tr>
    <tr><td class="paramname"><a class="el" href="struct_accel_data.html" title="Container for linear acceleration measurements.">AccelData</a></td><td>Shared container for linear accelerations </td></tr>
    <tr><td class="paramname">updateMs</td><td>Sample interval in milliseconds (default 500ms)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Calibration values must be determined for each specific sensor </dd>
<dd>
See <a class="el" href="#ace03e3c1d0c608ead75e259f9d334d6c" title="Perform interactive calibration procedure.">performCalibration()</a> for obtaining calibration offsets </dd></dl>

</div>
</div>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Member Function Documentation</h2>
<a id="a5f17e194f522641a58a0ff54ce4a65c6" name="a5f17e194f522641a58a0ff54ce4a65c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f17e194f522641a58a0ff54ce4a65c6">&#9670;&#160;</a></span>get_updateMs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t IMUTask::get_updateMs </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel noexcept">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get current sample interval. </p>
<dl class="section return"><dt>Returns</dt><dd>Sample period in milliseconds </dd></dl>

</div>
</div>
<a id="ad28cac79ccdfabaf0a303256d5538359" name="ad28cac79ccdfabaf0a303256d5538359"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad28cac79ccdfabaf0a303256d5538359">&#9670;&#160;</a></span>getCalibrationOffsets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IMUTask::getCalibrationOffsets </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structadafruit__bno055__offsets__t.html">adafruit_bno055_offsets_t</a> *</td>          <td class="paramname"><span class="paramname"><em>offsets</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read current calibration offsets from sensor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offsets</td><td>Pointer to structure to receive offset data </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a81db980a2c8f7be5174ccd20d39dd751" name="a81db980a2c8f7be5174ccd20d39dd751"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81db980a2c8f7be5174ccd20d39dd751">&#9670;&#160;</a></span>initIMU()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IMUTask::initIMU </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the BNO055 sensor hardware. </p>
<p>Initialize BNO055 IMU sensor hardware and configure operating mode.</p>
<p>Performs I2C communication test, sets NDOF mode, and verifies sensor presence. Must be called before starting the FreeRTOS task.</p>
<dl class="section return"><dt>Returns</dt><dd>true if sensor initialized successfully </dd>
<dd>
false if sensor not found or communication failed</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Prints diagnostic messages to Serial </dd>
<dd>
Sets sensor to NDOF (9-DOF fusion) mode automatically</dd></dl>
<p>Performs I2C communication test with the BNO055 sensor and sets it to NDOF (Nine Degrees of Freedom) fusion mode. This mode combines data from all three sensors (accelerometer, gyroscope, magnetometer) for optimal accuracy in absolute orientation tracking.</p>
<p>Initialization Steps:</p><ol type="1">
<li>Verify imu_ pointer is valid</li>
<li>Call begin() with NDOF mode parameter</li>
<li>Set imuInitialized_ flag based on result</li>
<li>Print diagnostic messages to Serial</li>
</ol>
<dl class="section return"><dt>Returns</dt><dd>true if sensor responded and entered NDOF mode successfully </dd>
<dd>
false if sensor not found, I2C error, or null pointer</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Must be called before starting FreeRTOS task </dd>
<dd>
NDOF mode requires calibration for accurate absolute orientation </dd>
<dd>
Prints diagnostic output to Serial for debugging </dd></dl>

</div>
</div>
<a id="a585d4d1660cb0384d7eda70a58832f1f" name="a585d4d1660cb0384d7eda70a58832f1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a585d4d1660cb0384d7eda70a58832f1f">&#9670;&#160;</a></span>isDataReliable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IMUTask::isDataReliable </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if sensor data is reliable (system calibration &gt;= 1) </p>
<dl class="section return"><dt>Returns</dt><dd>true if magnetic north found and data trustworthy </dd></dl>

</div>
</div>
<a id="adef8c108195c7960ee1b1e6bac093401" name="adef8c108195c7960ee1b1e6bac093401"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adef8c108195c7960ee1b1e6bac093401">&#9670;&#160;</a></span>isFullyCalibrated()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IMUTask::isFullyCalibrated </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if sensor is fully calibrated (all subsystems at level 3) </p>
<dl class="section return"><dt>Returns</dt><dd>true if fully calibrated </dd></dl>

</div>
</div>
<a id="a2c28e6a4d383a13bdda9e748de181530" name="a2c28e6a4d383a13bdda9e748de181530"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c28e6a4d383a13bdda9e748de181530">&#9670;&#160;</a></span>loadSavedCalibration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IMUTask::loadSavedCalibration </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load hardcoded calibration offsets Apply pre-saved calibration data from savedCalibrationData_ array. </p>

</div>
</div>
<a id="ace03e3c1d0c608ead75e259f9d334d6c" name="ace03e3c1d0c608ead75e259f9d334d6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace03e3c1d0c608ead75e259f9d334d6c">&#9670;&#160;</a></span>performCalibration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IMUTask::performCalibration </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>timeoutMs</em></span><span class="paramdefsep"> = </span><span class="paramdefval">60000</span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform interactive calibration procedure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timeoutMs</td><td>Maximum time to wait for full calibration (default 60 seconds) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Blocks until fully calibrated or timeout expires </dd>
<dd>
Prints instructions to Serial for user </dd></dl>

</div>
</div>
<a id="a8f4d046a615f404983eb9f055771b11d" name="a8f4d046a615f404983eb9f055771b11d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f4d046a615f404983eb9f055771b11d">&#9670;&#160;</a></span>printCalibrationOffsets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IMUTask::printCalibrationOffsets </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print current calibration offsets to Serial Useful for recording offsets to hardcode in firmware. </p>

</div>
</div>
<a id="a2445ab1fcc5f513a3b5acfb8a8968888" name="a2445ab1fcc5f513a3b5acfb8a8968888"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2445ab1fcc5f513a3b5acfb8a8968888">&#9670;&#160;</a></span>printCalibrationStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IMUTask::printCalibrationStatus </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print current calibration status to Serial Displays system, gyro, accel, and mag calibration levels (0-3) </p>

</div>
</div>
<a id="adfb9db9321d1d5e15f060e7da3e41a84" name="adfb9db9321d1d5e15f060e7da3e41a84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adfb9db9321d1d5e15f060e7da3e41a84">&#9670;&#160;</a></span>set_instance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void IMUTask::set_instance </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_i_m_u_task.html">IMUTask</a> *</td>          <td class="paramname"><span class="paramname"><em>inst</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel static">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set static instance pointer for <a class="el" href="class_f_s_m.html">FSM</a> callbacks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inst</td><td>Pointer to <a class="el" href="class_i_m_u_task.html" title="Continuous IMU sensor data acquisition task with FSM control.">IMUTask</a> instance </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a55ce116a01e25836c9f0094e788bd15c" name="a55ce116a01e25836c9f0094e788bd15c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55ce116a01e25836c9f0094e788bd15c">&#9670;&#160;</a></span>setCalibrationOffsets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IMUTask::setCalibrationOffsets </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structadafruit__bno055__offsets__t.html">adafruit_bno055_offsets_t</a> *</td>          <td class="paramname"><span class="paramname"><em>offsets</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write calibration offsets to sensor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">offsets</td><td>Pointer to structure containing offset data </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Allows restoring saved calibration for faster startup </dd></dl>

</div>
</div>
<a id="a09aee3391a75fa643391764a7a7c90b1" name="a09aee3391a75fa643391764a7a7c90b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09aee3391a75fa643391764a7a7c90b1">&#9670;&#160;</a></span>setSampleInterval()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void IMUTask::setSampleInterval </td>
          <td>(</td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>intervalMs</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Change sample interval at runtime. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">intervalMs</td><td>New sample period in milliseconds </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Takes effect on next sample </dd></dl>

</div>
</div>
<a id="abfa7658c2d1e6eda10bc332a48667e30" name="abfa7658c2d1e6eda10bc332a48667e30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfa7658c2d1e6eda10bc332a48667e30">&#9670;&#160;</a></span>start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IMUTask::start </td>
          <td>(</td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>priority</em></span><span class="paramdefsep"> = </span><span class="paramdefval">1</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t</td>          <td class="paramname"><span class="paramname"><em>core</em></span><span class="paramdefsep"> = </span><span class="paramdefval">-1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start the IMU FreeRTOS task. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">priority</td><td>Task priority (1 = low, higher = more important) </td></tr>
    <tr><td class="paramname">core</td><td>CPU core to pin task to (-1 = no pinning, 0 or 1 for specific core) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6dd4ce19e4790858f3a9e6a6f349d2ee" name="a6dd4ce19e4790858f3a9e6a6f349d2ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dd4ce19e4790858f3a9e6a6f349d2ee">&#9670;&#160;</a></span>update()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void IMUTask::update </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel noexcept">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Execute one <a class="el" href="class_f_s_m.html">FSM</a> cycle - read sensor and update shares. </p>
<p>Execute one <a class="el" href="class_f_s_m.html">FSM</a> cycle for IMU data acquisition.</p>
<dl class="section note"><dt>Note</dt><dd>Called repeatedly from FreeRTOS task loop</dd></dl>
<p>Called repeatedly from the FreeRTOS task loop. Delegates to the <a class="el" href="class_f_s_m.html">FSM</a> manager which executes the current state's function (exec_wait or exec_sendData).</p>
<dl class="section note"><dt>Note</dt><dd>Called at rate determined by updateMs_ parameter </dd>
<dd>
Thread-safe - uses Share&lt;T&gt; for all data outputs </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/tasks/<a class="el" href="_i_m_u___t_a_s_k_8h_source.html">IMU_TASK.h</a></li>
<li>src/tasks/<a class="el" href="_i_m_u___t_a_s_k_8cpp.html">IMU_TASK.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="class_i_m_u_task.html">IMUTask</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
