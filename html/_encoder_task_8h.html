<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sport Trackr Design Review: src/tasks/EncoderTask.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Sport Trackr Design Review<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">A sophisticated dual-axis motor control system that automatically tracks LED targets using computer vision feedback. The system combines real-time image processing, inertial measurement, and PID control to enable autonomous tracking or manual teleoperation via a web interface.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_encoder_task_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">EncoderTask.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>High-frequency encoder reading task with velocity calculation and telemetry.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;Arduino.h&gt;</code><br />
<code>#include &quot;<a class="el" href="_encoder_8h_source.html">../hardware/Encoder.h</a>&quot;</code><br />
<code>#include &quot;freertos/FreeRTOS.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_state_8h_source.html">../fsm/State.h</a>&quot;</code><br />
<code>#include &lt;cstdint&gt;</code><br />
<code>#include &quot;freertos/task.h&quot;</code><br />
<code>#include &quot;taskqueue.h&quot;</code><br />
<code>#include &quot;taskshare.h&quot;</code><br />
</div>
<p><a href="_encoder_task_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:EncoderTask" id="r_EncoderTask"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_encoder_task.html">EncoderTask</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">High-frequency encoder monitoring with <a class="el" href="class_f_s_m.html">FSM</a> control and velocity estimation.  <a href="class_encoder_task.html#details">More...</a><br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>High-frequency encoder reading task with velocity calculation and telemetry. </p>
<p>This task implements continuous encoder position monitoring using the ESP32's PCNT (Pulse Counter) peripheral. It reads quadrature encoder signals at high frequency, calculates angular velocity via numerical differentiation, and publishes both position and velocity data to shared memory for use by control loops.</p>
<p>Key Features:</p><ul>
<li>Hardware-accelerated quadrature decoding via PCNT peripheral</li>
<li>High-rate position updates (default 10ms = 100Hz)</li>
<li>Velocity calculation using first-order finite difference</li>
<li>Zero/home position support for calibration</li>
<li>FSM-based control for clean start/stop behavior</li>
<li>Thread-safe data publication via Share&lt;T&gt; containers</li>
</ul>
<p>Operating Modes:</p><ul>
<li><b>WAIT</b>: <a class="el" href="class_encoder.html" title="ESP32 PCNT-based quadrature encoder reader (X4), matching a MicroPython-style API.">Encoder</a> monitoring paused, awaiting command</li>
<li><b>RUN</b>: Continuous position and velocity measurement</li>
</ul>
<p>Data Output:</p><ul>
<li>Position: Accumulated angle in degrees from last zero operation</li>
<li>Velocity: Angular rate in degrees/second (calculated from position delta)</li>
</ul>
<p>Commands:</p><ul>
<li>cmdShare: 0=WAIT (pause), 1=RUN (active)</li>
<li>zeroShare: true=reset position to zero (home/calibrate)</li>
</ul>
<dl class="section author"><dt>Author</dt><dd><a class="el" href="class_encoder.html" title="ESP32 PCNT-based quadrature encoder reader (X4), matching a MicroPython-style API.">Encoder</a> Control Team </dd></dl>
<dl class="section date"><dt>Date</dt><dd>November 2025 </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.6</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="_encoder_task_8cpp.html" title="Implementation of high-frequency encoder monitoring with velocity calculation.">EncoderTask.cpp</a> for velocity calculation implementation </dd>
<dd>
<a class="el" href="_encoder_8h.html" title="ESP32 PCNT-based quadrature encoder interface with velocity smoothing.">Encoder.h</a> for PCNT hardware interface details </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a href="dir_b118c466441e8db851de69c6796245a3.html">tasks</a></li><li class="navelem"><a href="_encoder_task_8h.html">EncoderTask.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
