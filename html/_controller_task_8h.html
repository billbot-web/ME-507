<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sport Trackr Design Review: src/tasks/ControllerTask.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Sport Trackr Design Review<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">A sophisticated dual-axis motor control system that automatically tracks LED targets using computer vision feedback. The system combines real-time image processing, inertial measurement, and PID control to enable autonomous tracking or manual teleoperation via a web interface.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_controller_task_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">ControllerTask.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>High-level <a class="el" href="class_f_s_m.html">FSM</a> controller for camera-based tracking and manual control modes.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;Arduino.h&gt;</code><br />
<code>#include &lt;cstdint&gt;</code><br />
<code>#include &quot;freertos/FreeRTOS.h&quot;</code><br />
<code>#include &quot;freertos/task.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_f_s_m_8h_source.html">../fsm/FSM.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_state_8h_source.html">../fsm/State.h</a>&quot;</code><br />
<code>#include &quot;taskshare.h&quot;</code><br />
<code>#include &quot;taskqueue.h&quot;</code><br />
</div>
<p><a href="_controller_task_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:ControllerTask" id="r_ControllerTask"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_controller_task.html">ControllerTask</a></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>High-level <a class="el" href="class_f_s_m.html">FSM</a> controller for camera-based tracking and manual control modes. </p>
<p>This task implements the top-level control logic for a pan-tilt camera tracking system. It coordinates between multiple operating modes including automatic LED tracking, manual teleoperation, motor testing, and calibration. The task acts as the "brain" of the system, deciding when to track, when to scan, and how to respond to LED detection loss.</p>
<p>Operating Modes (<a class="el" href="class_f_s_m.html">FSM</a> States):</p><ul>
<li><b>CALIBRATE</b>: Runs encoder calibration sequence (homes motors)</li>
<li><b>WAIT</b>: System idle, motors stopped</li>
<li><b>SCAN</b>: Sweeping pattern to locate LED target</li>
<li><b>TRACKR</b>: Active tracking of detected LED using camera feedback</li>
<li><b>TELEOP</b>: Manual control via D-pad inputs from UI</li>
<li><b>MOTOR_TEST</b>: Open-loop motor testing for diagnostics</li>
</ul>
<p>Key Features:</p><ul>
<li>Camera error-based tracking with LED detection monitoring</li>
<li>Automatic scan recovery after target loss (5-frame persistence)</li>
<li>Manual control with D-pad for teleoperation</li>
<li>Position safety limits for tilt axis</li>
<li>Mode switching via UI commands</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Control Systems Team </dd></dl>
<dl class="section date"><dt>Date</dt><dd>November 2025 </dd></dl>
<dl class="section version"><dt>Version</dt><dd>2.1</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="_controller_task_8cpp.html" title="Implementation of top-level FSM controller for LED tracking and manual control.">ControllerTask.cpp</a> for <a class="el" href="class_f_s_m.html">FSM</a> state implementations and tracking logic </dd>
<dd>
<a class="el" href="_motor_task_8h.html" title="FreeRTOS task for comprehensive motor control with PID velocity and position control.">MotorTask.h</a> for motor control modes (VRUN, PRUN, CAMERA_PRUN) </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a href="dir_b118c466441e8db851de69c6796245a3.html">tasks</a></li><li class="navelem"><a href="_controller_task_8h.html">ControllerTask.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
