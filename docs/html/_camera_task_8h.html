<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sport Trackr Design Review: src/tasks/CameraTask.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Sport Trackr Design Review<span id="projectnumber">&#160;1</span>
   </div>
   <div id="projectbrief">A sophisticated dual-axis motor control system that automatically tracks LED targets using computer vision feedback. The system combines real-time image processing, inertial measurement, and PID control to enable autonomous tracking or manual teleoperation via a web interface.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('_camera_task_8h.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">CameraTask.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Computer vision task for LED detection and tracking error computation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;Arduino.h&gt;</code><br />
<code>#include &quot;<a class="el" href="_o_v5640__camera_8h_source.html">../hardware/OV5640_camera.h</a>&quot;</code><br />
<code>#include &quot;freertos/FreeRTOS.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_state_8h_source.html">../fsm/State.h</a>&quot;</code><br />
<code>#include &lt;cstdint&gt;</code><br />
<code>#include &quot;freertos/task.h&quot;</code><br />
<code>#include &quot;taskqueue.h&quot;</code><br />
<code>#include &quot;taskshare.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_f_s_m_8h_source.html">../fsm/FSM.h</a>&quot;</code><br />
</div>
<p><a href="_camera_task_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:CameraTask" id="r_CameraTask"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_camera_task.html">CameraTask</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Real-time LED detection and visual servoing error computation.  <a href="class_camera_task.html#details">More...</a><br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Computer vision task for LED detection and tracking error computation. </p>
<p>This task implements real-time LED detection and centroid tracking using the OV5640 camera module. It captures frames, processes them to find bright LED targets, and computes pixel errors (pan and tilt) from the image center for use in visual servoing.</p>
<p>Key Features:</p><ul>
<li>OV5640 camera frame capture and processing</li>
<li>Brightness-based LED detection with configurable threshold</li>
<li>Centroid calculation for precise target localization</li>
<li>Pixel error computation for visual servoing control</li>
<li>Frame streaming capability for web UI display</li>
<li>FSM-based operation modes for power management</li>
</ul>
<p>Operating Modes:</p><ul>
<li><b>WAIT</b>: Camera idle, no capture</li>
<li><b>CAP_SEND_ERR</b>: Capture frame, detect LED, compute and publish errors only</li>
<li><b>CAP_SEND_RETURN</b>: Full mode - capture, detect, compute errors, stream frame to UI</li>
</ul>
<p>Computer Vision Pipeline:</p><ol type="1">
<li>Capture frame from OV5640 camera</li>
<li>Scan pixels for brightness above threshold</li>
<li>Calculate centroid (center of mass) of bright pixels</li>
<li>Compute pixel errors: (centroid_x - image_center_x), (centroid_y - image_center_y)</li>
<li>Publish errors and detection flag via Share&lt;T&gt; objects</li>
<li>Optionally stream frame to web UI</li>
</ol>
<p>Data Output:</p><ul>
<li>pan_err: Horizontal pixel error (negative = LED left of center)</li>
<li>tilt_err: Vertical pixel error (negative = LED above center)</li>
<li>hasLed: Boolean flag indicating LED detected in current frame</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Computer Vision Team </dd></dl>
<dl class="section date"><dt>Date</dt><dd>November 2025 </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.1</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="_camera_task_8cpp.html" title="Implementation of LED detection and visual servoing error computation.">CameraTask.cpp</a> for LED detection algorithm implementation </dd>
<dd>
<a class="el" href="_o_v5640__camera_8h.html">OV5640_camera.h</a> for <a class="el" href="main_8cpp.html#a75f0a8d83ec4ecf50ce67b9df42431e7">camera</a> hardware interface </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a href="dir_b118c466441e8db851de69c6796245a3.html">tasks</a></li><li class="navelem"><a href="_camera_task_8h.html">CameraTask.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
